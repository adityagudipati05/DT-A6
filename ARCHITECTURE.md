# System Architecture & Data Flow

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FRONTEND (Next.js)                        â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  React Components                                          â”‚ â”‚
â”‚  â”‚  - StudentDashboard                                        â”‚ â”‚
â”‚  â”‚  - FacultyDashboard                                        â”‚ â”‚
â”‚  â”‚  - EventsList                                              â”‚ â”‚
â”‚  â”‚  - QRCodeDisplay                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  API Client (lib/apiClient.js)                             â”‚ â”‚
â”‚  â”‚  - studentLogin()                                          â”‚ â”‚
â”‚  â”‚  - getApprovedEvents()                                     â”‚ â”‚
â”‚  â”‚  - participateInEvent()                                    â”‚ â”‚
â”‚  â”‚  - scanQRCode()                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    HTTP/HTTPS â”‚ (REST API)
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND (Express.js)                        â”‚
â”‚                    Running on port 5000                          â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Routes Layer                                           â”‚   â”‚
â”‚  â”‚  - /api/students/*    â”€â–º studentRoutes.js              â”‚   â”‚
â”‚  â”‚  - /api/faculty/*     â”€â–º facultyRoutes.js              â”‚   â”‚
â”‚  â”‚  - /api/events/*      â”€â–º eventRoutes.js                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Controllers Layer (Business Logic)                     â”‚   â”‚
â”‚  â”‚  - studentController.js                                 â”‚   â”‚
â”‚  â”‚  - facultyController.js                                 â”‚   â”‚
â”‚  â”‚  - eventController.js                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Middleware Layer                                       â”‚   â”‚
â”‚  â”‚  - auth.js (JWT verification)                           â”‚   â”‚
â”‚  â”‚  - CORS handling                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Data Models (Mongoose)                                 â”‚   â”‚
â”‚  â”‚  - Student.js                                           â”‚   â”‚
â”‚  â”‚  - Faculty.js                                           â”‚   â”‚
â”‚  â”‚  - Event.js                                             â”‚   â”‚
â”‚  â”‚  - EventPass.js                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                          MongoDB â”‚ Query
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DATABASE (MongoDB Atlas)                       â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   Students   â”‚  â”‚   Faculty    â”‚  â”‚    Events    â”‚           â”‚
â”‚  â”‚ Collection   â”‚  â”‚ Collection   â”‚  â”‚ Collection   â”‚           â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚           â”‚
â”‚  â”‚ 6 Records    â”‚  â”‚ 4 Records    â”‚  â”‚ Dynamic      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                â”‚
â”‚  â”‚ EventPasses  â”‚                                                â”‚
â”‚  â”‚ Collection   â”‚                                                â”‚
â”‚  â”‚              â”‚                                                â”‚
â”‚  â”‚ Dynamic      â”‚                                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Diagrams

### Student Participation Flow

```
                    STUDENT
                       â”‚
                       â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   1. Login              â”‚
         â”‚ POST /api/students/loginâ”‚
         â”‚ (admissionNo, password) â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 2. Get JWT Token        â”‚
         â”‚ (Stored in localStorage)â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 3. View Events          â”‚
         â”‚ GET /api/events/approvedâ”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 4. Select Event         â”‚
         â”‚ Display Event Details   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 5. Participate          â”‚
         â”‚ POST /api/events/       â”‚
         â”‚ participate             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 6. Generate QR Code     â”‚
         â”‚ Auto-generated in DB    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 7. Get Event Passes     â”‚
         â”‚ GET /api/events/        â”‚
         â”‚ my-passes               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 8. Display QR Pass      â”‚
         â”‚ Show to Faculty         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 9. Attendance Marked    â”‚
         â”‚ Via Faculty Scan        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Faculty Approval Flow

```
                    FACULTY
                       â”‚
                       â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   1. Login              â”‚
         â”‚ POST /api/faculty/login â”‚
         â”‚ (facultyId, password)   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 2. Get JWT Token        â”‚
         â”‚ (Stored in localStorage)â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 3. Pending Requests     â”‚
         â”‚ GET /api/faculty/       â”‚
         â”‚ pending-requests        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 4. Review Event         â”‚
         â”‚ Check Details           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 5. Approve/Reject       â”‚
         â”‚ PUT /api/faculty/       â”‚
         â”‚ approve-event           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 6. Event Status Updated â”‚
         â”‚ Approved/Rejected       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 7. Scan QR Codes       â”‚
         â”‚ At Event Location      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 8. Mark Attendance      â”‚
         â”‚ POST /api/events/       â”‚
         â”‚ scan-qr                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 9. Attendance Recorded  â”‚
         â”‚ In Database             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Authentication Flow

```
Client                              Server
  â”‚                                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€ Login Request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚   {admissionNo, password}         â”‚
  â”‚                                   â”‚
  â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                          â”‚ Verify Credentialsâ”‚
  â”‚                          â”‚ (DB Lookup)      â”‚
  â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚                                   â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€ JWT Token â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚   (Valid for 7 days)              â”‚
  â”‚                                   â”‚
  â”‚ [Token stored in localStorage]    â”‚
  â”‚                                   â”‚
  â”œâ”€â”€â”€â”€â”€â–º Subsequent Request â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚   Headers: {                      â”‚
  â”‚     Authorization: Bearer TOKEN   â”‚
  â”‚   }                               â”‚
  â”‚                                   â”‚
  â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                          â”‚ Verify Token     â”‚
  â”‚                          â”‚ Check Expiry     â”‚
  â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚                                   â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€ Response + Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚   (If token valid)                â”‚
  â”‚                                   â”‚
```

---

## ğŸ“ˆ Event Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  EVENT LIFECYCLE                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ CREATION
   Student hosts event
   Status: PENDING
   â”œâ”€ Title
   â”œâ”€ Date
   â”œâ”€ Location
   â””â”€ Max Participants

2ï¸âƒ£ APPROVAL QUEUE
   Event waiting for faculty review
   Status: PENDING
   â””â”€ Listed in faculty dashboard

3ï¸âƒ£ APPROVED
   Faculty approves event
   Status: APPROVED
   â”œâ”€ Visible to students
   â””â”€ QR code generated

4ï¸âƒ£ PARTICIPATION
   Students register
   Status: ACTIVE
   â”œâ”€ Event pass generated
   â”œâ”€ QR code created
   â””â”€ Added to participants

5ï¸âƒ£ EVENT DAY
   Students show QR passes
   â”œâ”€ Faculty scans QR
   â”œâ”€ Attendance marked
   â””â”€ Status: USED

6ï¸âƒ£ COMPLETED
   Event ends
   Status: COMPLETED
   â””â”€ Attendance finalized

Alternative: REJECTED
   Faculty rejects event
   Status: REJECTED
   â””â”€ Not visible to students
```

---

## ğŸ—„ï¸ Database Schema Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Student      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _id             â”‚
â”‚ admissionNo     â”‚
â”‚ name            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ password        â”‚                         â”‚
â”‚ email           â”‚                         â”‚
â”‚ phone           â”‚                         â”‚
â”‚ department      â”‚                         â”‚
â”‚ semester        â”‚                         â”‚
â”‚ attendance      â”‚                         â”‚
â”‚ hostedEvents[]  â”‚â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚ participatedE[]â”‚â”€â”€â”€â”€â”€â”€â”¤â”                 â”‚
â”‚ eventPasses[]  â”‚â”€â”€â”€â”€â”€â”€â”¤â”œâ”€â”              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚â”‚â”‚ â”‚              â”‚
                       â”‚â”‚â”‚ â”‚              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚â”‚â”‚ â”‚              â”‚
â”‚    Faculty      â”‚    â”‚â”‚â”‚ â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚â”‚â”‚ â”‚              â”‚
â”‚ _id             â”‚    â”‚â”‚â”‚ â”‚              â”‚
â”‚ facultyId       â”‚    â”‚â”‚â”‚ â”‚              â”‚
â”‚ name            â”‚â”€â”€â”€â”€â”¼â”¼â”¼â”€â”¤              â”‚
â”‚ password        â”‚    â”‚â”‚â”‚ â”‚              â”‚
â”‚ email           â”‚    â”‚â”‚â”‚ â”‚              â”‚
â”‚ phone           â”‚    â”‚â”‚â”‚ â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ department      â”‚    â”‚â”‚â”‚ â”‚    â”‚                   â”‚
â”‚ designation     â”‚    â”‚â”‚â”‚ â”‚    â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚â”‚â”‚ â”‚    â”‚                   â”‚
                       â”‚â”‚â”‚ â”‚    â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚â”‚â”‚ â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Event       â”‚    â”‚â”‚â”‚ â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚â”‚â”‚      â”‚    â”‚                       â”‚
â”‚ _id             â”‚    â”‚â”‚â”‚      â”‚ â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚ title           â”‚    â”‚â”‚â”‚      â”‚ â”‚                â”‚        â”‚
â”‚ description     â”‚    â”‚â”‚â”‚      â”‚ â”‚                â”‚        â”‚
â”‚ hostId (FK)     â”‚â—„â”€â”€â”€â”¼â”˜â”‚      â”‚ â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”‚
â”‚ date            â”‚    â”‚ â”‚      â”‚ â”‚    â”‚                 â”‚  â”‚
â”‚ location        â”‚    â”‚ â”‚      â”œâ”€â”¼â”€â”€â”€â–ºâ”‚   EventPass      â”‚  â”‚
â”‚ category        â”‚    â”‚ â”‚      â”‚ â”‚    â”‚                 â”‚  â”‚
â”‚ maxParticipants â”‚    â”‚ â”‚      â”‚ â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ participants[]  â”‚    â”‚ â”‚      â”‚ â”‚    â”‚ _id             â”‚  â”‚
â”‚ approvalStatus  â”‚    â”‚ â”‚      â”‚ â”‚    â”‚ studentId (FK)  â”‚  â”‚
â”‚ approvedBy      â”‚    â”‚ â”‚      â”‚ â”‚    â”‚ eventId (FK)    â”‚  â”‚
â”‚ qrCode          â”‚    â”‚ â”‚      â”‚ â”‚    â”‚ qrCode (image)  â”‚  â”‚
â”‚ attendanceM[]   â”‚    â”‚ â”‚      â”‚ â”‚    â”‚ passStatus      â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚      â”‚ â”‚    â”‚ scannedAt       â”‚  â”‚
                       â”‚ â”‚      â”‚ â”‚    â”‚ scannedBy (FK)  â”‚  â”‚
                       â”‚ â”‚      â”‚ â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                       â”‚ â”‚      â”‚ â”‚                         â”‚
                       â”‚ â””â”€â”€â”€â”€â”€â”€â”¼â”€â”˜                         â”‚
                       â”‚        â”‚                          â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
                                â”‚                          â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request-Response Cycle

```
CLIENT REQUEST
    â”‚
    â–¼
1. HTTP Request with JWT in header
   GET /api/events/approved
   Headers: {Authorization: Bearer eyJhbGciOiJIUzI1NiIs...}

    â”‚
    â–¼
2. Express receives request
   app.use(express.json())
   CORS headers added

    â”‚
    â–¼
3. Route Matching
   /api/events/approved â†’ eventRoutes.js

    â”‚
    â–¼
4. Authentication Middleware
   authenticateToken()
   â””â”€ Verify JWT signature
   â””â”€ Check token expiry
   â””â”€ Extract userId and role

    â”‚
    â–¼
5. Controller Logic
   getApprovedEvents()
   â””â”€ Query MongoDB
   â””â”€ Filter by approvalStatus === "Approved"
   â””â”€ Populate references

    â”‚
    â–¼
6. Database Query
   Event.find({ approvalStatus: "Approved" })
   .populate("hostId")
   .populate("participants")

    â”‚
    â–¼
7. Response Construction
   JSON.stringify(events)
   Status: 200 OK

    â”‚
    â–¼
CLIENT RECEIVES RESPONSE
    â”‚
    â–¼
8. Frontend processes
   Display events in UI
   User can interact
```

---

## ğŸ¯ Error Handling Flow

```
Request with Error
    â”‚
    â–¼
1. Missing Token?
   â”œâ”€ Yes â†’ 401 Unauthorized
   â”‚         "Access token required"
   â””â”€ No â†’ Continue

2. Invalid Token?
   â”œâ”€ Yes â†’ 403 Forbidden
   â”‚         "Invalid or expired token"
   â””â”€ No â†’ Continue

3. Role Mismatch?
   â”œâ”€ Yes â†’ 403 Forbidden
   â”‚         "Unauthorized access"
   â””â”€ No â†’ Continue

4. Database Error?
   â”œâ”€ Yes â†’ 500 Server Error
   â”‚         "Error message"
   â””â”€ No â†’ Continue

5. Validation Error?
   â”œâ”€ Yes â†’ 400 Bad Request
   â”‚         "Invalid input"
   â””â”€ No â†’ Return 200 Success
```

---

Generated: November 11, 2025  
Status: âœ… Architecture Complete
